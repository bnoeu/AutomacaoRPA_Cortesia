2024-12-01 14:41:15,733 - INFO - 394 = <module> - --- Iniciando o Try-Catch do PROGRAMA PRINCIPAL
2024-12-01 14:41:15,733 - INFO - 85 = programa_principal - 



2024-12-01 14:41:15,736 - INFO - 86 = programa_principal - ---------------------------------------------------------------------------------------------------
2024-12-01 14:41:15,736 - INFO - 87 = programa_principal - --- INICIANDO UM NOVO LANÇAMENTO DE NFE --- 
2024-12-01 14:41:15,737 - INFO - 88 = programa_principal - ---------------------------------------------------------------------------------------------------
2024-12-01 14:41:24,702 - INFO - 249 = abre_planilha_navegador - --- Planilha já estava aberta, executou apenas um recarregamento
2024-12-01 14:41:24,702 - INFO - 33 = coleta_planilha - --- Copiando dados e formatando na planilha de debug
2024-12-01 14:41:31,846 - INFO - 150 = reaplica_filtro_status - --- Navegou até celula A1 e abriu o filtro do status 
2024-12-01 14:41:32,384 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_planilha/bt_aplicar.png na posição: Point(x=1407, y=961) ( Tentativa: 0, Confiança: 0.78 )
2024-12-01 14:41:33,907 - INFO - 153 = reaplica_filtro_status - --- Na tela do menu de filtro, clicou no botão "Aplicar" para reaplicar o filtro 
2024-12-01 14:41:34,309 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_planilha/bt_visualizar_todos.png na posição: Point(x=1122, y=617) ( Tentativa: 0, Confiança: 0.78 )
2024-12-01 14:41:34,726 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_planilha/bt_visualizar_todos.png na posição: Point(x=1122, y=617) ( Tentativa: 0, Confiança: 0.78 )
2024-12-01 14:41:36,250 - INFO - 157 = reaplica_filtro_status - --- Clicou para visualizar o filtro de todos.
2024-12-01 14:41:39,757 - INFO - 161 = reaplica_filtro_status - --- Filtro reaplicado com sucesso
2024-12-01 14:41:46,988 - INFO - 56 = processa_dados - --- Dados copiados com sucesso: 35241156899602000268550010008133731164089832
2024-12-01 14:41:46,988 - SUCCESS - 15 = success - --- Processo de coleta da planilha foi executado corretamente.
2024-12-01 14:41:46,988 - INFO - 31 = valida_lancamento - --- Alterando o TopCompras para o modo incluir
2024-12-01 14:42:22,030 - ERROR - 399 = <module> - --- A execução principal apresentou erro! Executando o script PROGRAMA PRINCIPAL novamente.
Traceback (most recent call last):
  File "c:\Users\bruno.santos\Documents\GitHub\AutomacaoRPA_Cortesia\Materia_Prima.py", line 395, in <module>
    programa_principal()
  File "c:\Users\bruno.santos\Documents\GitHub\AutomacaoRPA_Cortesia\Materia_Prima.py", line 93, in programa_principal
    dados_planilha = valida_lancamento() # Coleta e confere os dados do lançamento atual
                     ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\bruno.santos\Documents\GitHub\AutomacaoRPA_Cortesia\valida_lancamento.py", line 33, in valida_lancamento
    ahk.win_wait_active('TopCompras', title_match_mode= 2, timeout= 30)
  File "C:\Users\bruno.santos\AppData\Local\Programs\Python\Python311\Lib\site-packages\ahk\_sync\engine.py", line 3351, in win_wait_active
    resp = self._transport.function_call('AHKWinWaitActive', args, blocking=blocking, engine=self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bruno.santos\AppData\Local\Programs\Python\Python311\Lib\site-packages\ahk\_sync\transport.py", line 532, in function_call
    return self.send(request, engine=engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bruno.santos\AppData\Local\Programs\Python\Python311\Lib\site-packages\ahk\_sync\transport.py", line 745, in send
    return response.unpack()  # type: ignore
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\bruno.santos\AppData\Local\Programs\Python\Python311\Lib\site-packages\ahk\message.py", line 216, in unpack
    raise self._exception_type(s)
TimeoutError: WinWait timed out waiting for window
2024-12-01 14:42:22,032 - INFO - 400 = <module> - --- Reiniciando o TopCon e TopCompras para garantir a execução correta.
2024-12-01 14:42:22,032 - INFO - 110 = abre_topcon - --- Executando a função: ABRE TOPCON
2024-12-01 14:42:22,033 - INFO - 83 = fecha_execucoes - --- Iniciando fecha execucoes, para fechar o TopCompras e o RDP ---
2024-12-01 14:42:22,430 - INFO - 88 = fecha_execucoes - --- Fechou a tela "Vinculação itens da nota" 
2024-12-01 14:42:23,321 - INFO - 101 = fecha_execucoes - --- Fechou a tela "TopCompras" 
2024-12-01 14:42:23,856 - INFO - 106 = fecha_execucoes - --- Fechou o processo MSTSC.EXE" 
2024-12-01 14:42:23,856 - INFO - 120 = abre_topcon - --- Iniciando o RemoteApp
2024-12-01 14:42:34,519 - INFO - 128 = abre_topcon - --- Tentando a tela: Windows Security
2024-12-01 14:42:34,633 - INFO - 134 = abre_topcon - --- Encontrou com o nome Windows Security
2024-12-01 14:42:34,743 - INFO - 128 = abre_topcon - --- Tentando a tela: Segurança do Windows
2024-12-01 14:42:42,249 - INFO - 143 = abre_topcon - --- Abriu a tela "Windows Security", realizando o login" 
2024-12-01 14:42:45,630 - INFO - 151 = abre_topcon - --- Login realizado no RemoteApp-Cortesia.rdp
2024-12-01 14:42:45,630 - INFO - 28 = abre_mercantil - --- Realizando a abertura do modulo de compras
2024-12-01 14:42:54,265 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_topcon/icone_modulo_compras.png na posição: Point(x=71, y=811) ( Tentativa: 0, Confiança: 0.67 )
2024-12-01 14:42:59,980 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_topcon/botao_ok.jpg na posição: Point(x=1127, y=971) ( Tentativa: 0, Confiança: 0.78 )
2024-12-01 14:43:00,196 - INFO - 67 = navega_topcompras - --- Executando a função: navega topcompras 
2024-12-01 14:43:08,405 - INFO - 78 = navega_topcompras - --- TopCompras aberto!
2024-12-01 14:43:08,405 - INFO - 394 = <module> - --- Iniciando o Try-Catch do PROGRAMA PRINCIPAL
2024-12-01 14:43:08,405 - INFO - 85 = programa_principal - 



2024-12-01 14:43:08,405 - INFO - 86 = programa_principal - ---------------------------------------------------------------------------------------------------
2024-12-01 14:43:08,405 - INFO - 87 = programa_principal - --- INICIANDO UM NOVO LANÇAMENTO DE NFE --- 
2024-12-01 14:43:08,405 - INFO - 88 = programa_principal - ---------------------------------------------------------------------------------------------------
2024-12-01 14:43:17,122 - INFO - 249 = abre_planilha_navegador - --- Planilha já estava aberta, executou apenas um recarregamento
2024-12-01 14:43:17,122 - INFO - 33 = coleta_planilha - --- Copiando dados e formatando na planilha de debug
2024-12-01 14:43:24,275 - INFO - 150 = reaplica_filtro_status - --- Navegou até celula A1 e abriu o filtro do status 
2024-12-01 14:43:24,789 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_planilha/bt_aplicar.png na posição: Point(x=1407, y=961) ( Tentativa: 0, Confiança: 0.78 )
2024-12-01 14:43:26,308 - INFO - 153 = reaplica_filtro_status - --- Na tela do menu de filtro, clicou no botão "Aplicar" para reaplicar o filtro 
2024-12-01 14:43:26,716 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_planilha/bt_visualizar_todos.png na posição: Point(x=1122, y=617) ( Tentativa: 0, Confiança: 0.78 )
2024-12-01 14:43:27,139 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_planilha/bt_visualizar_todos.png na posição: Point(x=1122, y=617) ( Tentativa: 0, Confiança: 0.78 )
2024-12-01 14:43:28,664 - INFO - 157 = reaplica_filtro_status - --- Clicou para visualizar o filtro de todos.
2024-12-01 14:43:32,173 - INFO - 161 = reaplica_filtro_status - --- Filtro reaplicado com sucesso
2024-12-01 14:43:39,411 - INFO - 56 = processa_dados - --- Dados copiados com sucesso: 35241156899602000268550010008133731164089832
2024-12-01 14:43:39,411 - SUCCESS - 15 = success - --- Processo de coleta da planilha foi executado corretamente.
2024-12-01 14:43:39,411 - INFO - 31 = valida_lancamento - --- Alterando o TopCompras para o modo incluir
2024-12-01 14:43:39,649 - INFO - 36 = valida_lancamento - --- Verificando se está no modo Localizar.
2024-12-01 14:43:41,368 - INFO - 40 = valida_lancamento - --- Não está no modo Localizar, enviando comando F2 para tentar entrar no modo, tentativa: 0
2024-12-01 14:43:41,968 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_topcon/txt_localizar.png na posição: Point(x=939, y=1001) ( Tentativa: 0, Confiança: 0.78 )
2024-12-01 14:43:41,968 - INFO - 45 = valida_lancamento - --- Entrou no modo localizar, mudando para o modo incluir, tentativa: 0
2024-12-01 14:43:42,279 - INFO - 36 = valida_lancamento - --- Verificando se está no modo Localizar.
2024-12-01 14:43:42,670 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_topcon/txt_inclui.png na posição: Point(x=925, y=1002) ( Tentativa: 0, Confiança: 0.78 )
2024-12-01 14:43:44,261 - INFO - 67 = valida_lancamento - --- Entrou no modo incluir, continuando inserção da NFE
2024-12-01 14:43:47,039 - INFO - 16 = conferencia_xml - --- Iniciando a função: CONFERENCIA XML ---
2024-12-01 14:43:51,223 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_topcon/botao_sim.jpg na posição: Point(x=989, y=626) ( Tentativa: 0, Confiança: 0.73 )
2024-12-01 14:43:51,223 - INFO - 31 = conferencia_xml - --- XML Validado, indo para validação do pedido
2024-12-01 14:43:51,701 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_topcon/botao_sim.jpg na posição: Point(x=989, y=626) ( Tentativa: 0, Confiança: 0.78 )
2024-12-01 14:43:51,922 - SUCCESS - 15 = success - --- Validou o XML! Prosseguindo para a seleção do pedido: True
2024-12-01 14:43:51,922 - INFO - 51 = valida_pedido - --- Executando função: valida pedido
2024-12-01 14:43:54,547 - INFO - 76 = valida_pedido - --- O item: BRITADA 01 é igual ao item extraido: PEDRA BRITADA 01, procurando a imagem: PED_BRITA1.jpg
2024-12-01 14:43:55,076 - INFO - 128 = valida_pedido - --- Tentativa: 0, achou o PEDRA BRITADA 01 na posição Box(left=270, top=226, width=69, height=19)
2024-12-01 14:43:56,899 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_topcon/localizar.png na posição: Point(x=856, y=194) ( Tentativa: 0, Confiança: 0.78 )
2024-12-01 14:43:58,539 - INFO - 200 = verifica_ped_vazio - --- Item da nota: PEDRA BRITADA 01, texto que ainda ficou: PEDRA BRITADA 01, tamanho do texto 16
2024-12-01 14:43:58,539 - INFO - 204 = verifica_ped_vazio - --- Itens XML ainda tem informação!
2024-12-01 14:43:58,539 - INFO - 135 = valida_pedido - --- Valor campo "item XML": False
2024-12-01 14:43:58,948 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_topcon/vinc_xml_pedido.png na posição: Point(x=1091, y=612) ( Tentativa: 0, Confiança: 0.78 )
2024-12-01 14:44:00,529 - INFO - 200 = verifica_ped_vazio - --- Item da nota: PEDRA BRITADA 01, texto que ainda ficou: PEDRA BRITADA 01, tamanho do texto 16
2024-12-01 14:44:00,529 - INFO - 204 = verifica_ped_vazio - --- Itens XML ainda tem informação!
2024-12-01 14:44:00,529 - INFO - 140 = valida_pedido - --- Valor campo "vazio": False
2024-12-01 14:44:04,733 - INFO - 200 = verifica_ped_vazio - --- Item da nota: PEDRA BRITADA 01, texto que ainda ficou: PEDRA BRITADA 01, tamanho do texto 16
2024-12-01 14:44:04,733 - INFO - 204 = verifica_ped_vazio - --- Itens XML ainda tem informação!
2024-12-01 14:44:05,546 - INFO - 128 = valida_pedido - --- Tentativa: 0, achou o PEDRA BRITADA 01 na posição Box(left=270, top=274, width=69, height=19)
2024-12-01 14:44:07,348 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_topcon/localizar.png na posição: Point(x=856, y=194) ( Tentativa: 0, Confiança: 0.78 )
2024-12-01 14:44:09,006 - INFO - 200 = verifica_ped_vazio - --- Item da nota: PEDRA BRITADA 01, texto que ainda ficou: I, tamanho do texto 1
2024-12-01 14:44:09,006 - INFO - 207 = verifica_ped_vazio - --- Itens XML ficou vazio! saindo da tela de vinculação
2024-12-01 14:44:09,740 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_topcon/confirma.png na posição: Point(x=1026, y=914) ( Tentativa: 0, Confiança: 0.78 )
2024-12-01 14:44:11,401 - INFO - 66 = procura_imagem - --- Encontrou imagens/img_topcon/botao_ok.jpg na posição: Point(x=1070, y=627) ( Tentativa: 0, Confiança: 0.73 )
2024-12-01 14:44:12,324 - INFO - 219 = verifica_ped_vazio - --- Encerrado a função verifica pedido vazio!
2024-12-01 14:44:12,324 - INFO - 135 = valida_pedido - --- Valor campo "item XML": True
2024-12-01 14:44:12,324 - SUCCESS - 15 = success - --- Pedido validado, saindo do loop dos pedidos encontrados, valor do campo: True
2024-12-01 14:44:12,324 - SUCCESS - 15 = success - --- Pedido validado, retornando para o programa principal
